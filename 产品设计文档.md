# Excel字段转换工具 - 产品设计文档

## 1. 产品概述

### 1.1 产品定位
Excel字段转换工具是一款跨平台（Mac/Windows）的桌面应用程序，专门用于智能转换Excel文件中的字段值。通过集成AI大模型能力，为用户提供智能化的字段值映射和转换服务。

### 1.2 核心价值
- **智能映射**：基于Gemini大模型自动生成字段值对应关系
- **简化操作**：直观的GUI界面，降低用户操作门槛
- **高效转换**：批量处理Excel文件中的字段值转换
- **跨平台**：支持Mac和Windows操作系统

## 2. 目标用户

### 2.1 主要用户群体
- 数据分析师
- 业务运营人员
- Excel重度用户
- 需要进行数据清洗和标准化的用户

### 2.2 用户痛点
- 手动转换Excel字段值效率低下
- 大量数据的字段值映射容易出错
- 缺乏智能化的转换建议
- 需要重复性的数据清洗工作

## 3. 功能需求

### 3.1 核心功能流程

#### 3.1.1 文件上传模块
- **功能**：用户选择并上传Excel文件
- **要求**：支持.xlsx、.xls格式
- **验证**：文件格式验证、文件大小限制

#### 3.1.2 工作表选择模块
- **功能**：显示Excel文件中所有工作表
- **默认行为**：自动选择第一个工作表
- **用户操作**：可手动切换工作表

#### 3.1.3 表头读取模块
- **功能**：读取并显示选中工作表的表头
- **展示方式**：列表形式显示所有列名
- **数据预览**：显示前几行数据供用户参考

#### 3.1.4 字段选择模块
- **功能**：用户选择需要转换的目标字段
- **交互方式**：下拉列表或单选按钮
- **数据统计**：显示选中字段的基本统计信息

#### 3.1.5 唯一值分析模块
- **功能**：提取选中字段的所有唯一值
- **展示方式**：列表显示，按出现频次排序
- **数据量**：显示唯一值数量和总数据量

#### 3.1.6 转换目标设定模块
- **功能**：用户输入期望的转换目标描述
- **输入方式**：文本框输入
- **示例提示**：提供常见转换场景的示例

#### 3.1.7 AI映射生成模块
- **功能**：调用Gemini大模型生成字段映射关系
- **输入**：原始字段值列表 + 用户转换目标描述
- **输出**：建议的字段值对应关系

#### 3.1.8 映射关系编辑模块
- **功能**：展示AI生成的映射关系，允许用户编辑
- **交互方式**：表格形式，支持直接编辑
- **操作**：添加、删除、修改映射关系

#### 3.1.9 转换执行模块
- **功能**：执行字段值转换操作
- **进度显示**：实时显示转换进度
- **错误处理**：处理转换过程中的异常情况

#### 3.1.10 结果输出模块
- **功能**：保存转换后的Excel文件
- **文件命名**：自动生成带时间戳的文件名
- **完成提示**：显示转换完成状态和统计信息

### 3.2 辅助功能

#### 3.2.1 历史记录
- 保存用户的转换历史
- 支持重复使用历史映射关系

#### 3.2.2 模板功能
- 支持保存和加载映射模板
- 提供常用转换模板

#### 3.2.3 数据预览
- 转换前后数据对比预览
- 支持撤销操作

## 4. 用户界面设计

### 4.1 主界面布局
```
┌─────────────────────────────────────────────────────────┐
│ Excel字段转换工具                               [最小化][关闭] │
├─────────────────────────────────────────────────────────┤
│ 步骤导航: ① 上传文件 → ② 选择字段 → ③ 设置转换 → ④ 执行转换   │
├─────────────────────────────────────────────────────────┤
│                                                         │
│                    主要操作区域                          │
│                                                         │
│                                                         │
│                                                         │
├─────────────────────────────────────────────────────────┤
│ 状态栏：[当前状态] [进度条] [帮助]                       │
└─────────────────────────────────────────────────────────┘
```

### 4.2 各步骤界面要素

#### 步骤1: 文件上传界面
- 拖拽区域或文件选择按钮
- 支持的文件格式说明
- 文件信息显示区域

#### 步骤2: 字段选择界面
- 工作表选择下拉框
- 表头列表展示
- 字段选择控件
- 数据预览区域

#### 步骤3: 转换设置界面
- 唯一值列表展示
- 转换目标输入框
- AI生成按钮
- 映射关系编辑表格

#### 步骤4: 执行转换界面
- 转换确认信息
- 进度条和状态显示
- 取消操作按钮

## 5. 非功能性需求

### 5.1 性能要求
- 支持处理最大100万行数据的Excel文件
- AI映射生成响应时间不超过30秒
- 转换操作响应时间与数据量成线性关系

### 5.2 兼容性要求
- 支持macOS 10.15及以上版本
- 支持Windows 10及以上版本
- 支持Excel 2016及以上版本格式

### 5.3 安全要求
- 本地处理数据，不上传敏感信息
- API密钥本地加密存储
- 用户数据隐私保护

### 5.4 易用性要求
- 界面操作直观简洁
- 提供操作指引和帮助文档
- 支持键盘快捷键操作

## 6. 产品发布计划

### 6.1 MVP版本功能
- 基础的Excel文件读取和转换
- 简单的AI映射生成
- 基本的GUI界面

### 6.2 完整版本功能
- 所有设计功能的完整实现
- 历史记录和模板功能
- 高级的数据预览和编辑功能

### 6.3 未来版本规划
- 支持更多文件格式（CSV、JSON等）
- 支持更多AI模型选择
- 添加数据可视化功能
